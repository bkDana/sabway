<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="mgr">
	<insert id="enrollMgr" parameterType="mgr">
		insert into manager values(seq_mgr_no.nextval,#{mgrId}, #{mgrPw}, #{mgrName}, #{mgrTel}, #{mgrPost}, #{mgrAddr}, #{mgrLevel}, #{mgrStatus}, sysdate, #{mgrAddrCode}, #{mgrBossName}, sysdate,0)
	</insert>
	<select id="mgrList" resultType="mgr">
		select mgr_no as mgrNo
	      ,mgr_id as mgrId
	      ,mgr_pw as mgrPw
	      ,mgr_name as mgrName
	      ,mgr_tel as mgrTel
	      ,mgr_post as mgrPost
	      ,mgr_addr as mgrAddr
	      ,mgr_level as mgrLevel
	      ,mgr_status as mgrStatus
	      ,mgr_enroll_date as mgrEnrollDate
	      ,mgr_addr_code as mgrAddrCode
	      ,mgr_boss_name as mgrBossName
	      ,mgr_open_date as mgrOpenDate
	      from manager
	</select>
	<select id="mpdList" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="mgr">
		select mgr_no as mgrNo
	      ,mgr_id as mgrId
	      ,mgr_pw as mgrPw
	      ,mgr_name as mgrName
	      ,mgr_tel as mgrTel
	      ,mgr_post as mgrPost
	      ,mgr_addr as mgrAddr
	      ,mgr_level as mgrLevel
	      ,mgr_status as mgrStatus
	      ,mgr_enroll_date as mgrEnrollDate
	      ,mgr_addr_code as mgrAddrCode
	      ,mgr_boss_name as mgrBossName
	      ,mgr_open_date as mgrOpenDate        
	      from 
	        (select rownum as rnum, m.* from (select * from manager order by mgr_no) m)
	      where rnum between #{firstPage} and #{lastPage}
	</select>
	
	<select id="newStoreList" resultType="mgr">
		select mgr_no as mgrNo
		,mgr_id as mgrId
		,mgr_pw as mgrPw
		,mgr_name as mgrName
		,mgr_tel as mgrTel
		,mgr_post as mgrPost
		,mgr_addr as mgrAddr
		,mgr_level as mgrLevel
		,mgr_status as mgrStatus
		,mgr_enroll_date as mgrEnrollDate
		,mgr_addr_code as mgrAddrCode
		,mgr_boss_name as mgrBossName
		,mgr_open_date as mgrOpenDate
		from manager 
	</select>
	
	<select id="storeTotalCount" resultType="_int">
		select count(*) cnt from manager	
	</select>
	
	
	<select id="storeSelectPaging" parameterType="pb" resultType="mgr">
		select
		rnum 
		,mgr_no as mgrNo
		,mgr_id as mgrId
		,mgr_pw as mgrPw
		,mgr_name as mgrName
		,mgr_tel as mgrTel
		,mgr_post as mgrPost
		,mgr_addr as mgrAddr
		,mgr_level as mgrLevel
		,mgr_status as mgrStatus
		,mgr_enroll_date as mgrEnrollDate
		,mgr_addr_code as mgrAddrCode
		,mgr_boss_name as mgrBossName
		,mgr_open_date as mgrOpenDate
		from (select rownum as rnum, m.* from (select * from manager 
		<if test="keyword != null and keyword != '' and keyword != 'null' ">
			where mgr_addr like '%'||#{keyword}||'%' or mgr_name like '%'||#{keyword}||'%'
		</if>
		order by mgr_enroll_date desc) m)
		<if test="start != 0">
		 where rnum between #{start} and #{end}
		</if>
	</select>
	
	<select id="login" parameterType="mgr" resultType="mgr">
		select mgr_no as mgrNo
		,mgr_id as mgrId
		,mgr_pw as mgrPw
		,mgr_name as mgrName
		,mgr_tel as mgrTel
		,mgr_post as mgrPost
		,mgr_addr as mgrAddr
		,mgr_level as mgrLevel
		,mgr_status as mgrStatus
		,mgr_enroll_date as mgrEnrollDate
		,mgr_addr_code as mgrAddrCode
		,mgr_boss_name as mgrBossName
		,mgr_open_date as mgrOpenDate
		from manager
		where mgr_id = #{mgrId} and mgr_pw = #{mgrPw}
	</select>
	<update id="mgrUpdate" parameterType="mgr">
		update manager set mgr_status = #{mgrStatus} where mgr_name = #{mgrName}
	</update>
	<update id="mgrOpenUpdate" parameterType="mgr">
		update manager set mgr_status = #{mgrStatus}, mgr_open_date = sysdate where mgr_name = #{mgrName}
	</update>
	
	<select id="searchBossName" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="mgr">
		select mgr_no as mgrNo
		,mgr_id as mgrId
		,mgr_pw as mgrPw
		,mgr_name as mgrName
		,mgr_tel as mgrTel
		,mgr_post as mgrPost
		,mgr_addr as mgrAddr
		,mgr_level as mgrLevel
		,mgr_status as mgrStatus
		,mgr_enroll_date as mgrEnrollDate
		,mgr_addr_code as mgrAddrCode
		,mgr_boss_name as mgrBossName
		,mgr_open_date as mgrOpenDate
		from
	    (select rownum as rnum, m.* from (select * from manager where mgr_boss_name like '%'||#{text}||'%' order by mgr_no) m)
	    where rnum between #{firstPage} and #{lastPage}
	</select>
	<select id="searchAddr" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="mgr">
		select mgr_no as mgrNo
		,mgr_id as mgrId
		,mgr_pw as mgrPw
		,mgr_name as mgrName
		,mgr_tel as mgrTel
		,mgr_post as mgrPost
		,mgr_addr as mgrAddr
		,mgr_level as mgrLevel
		,mgr_status as mgrStatus
		,mgr_enroll_date as mgrEnrollDate
		,mgr_addr_code as mgrAddrCode
		,mgr_boss_name as mgrBossName
		,mgr_open_date as mgrOpenDate
		from
	    (select rownum as rnum, m.* from (select * from manager where mgr_addr like '%'||#{text}||'%' order by mgr_no) m)
	    where rnum between #{firstPage} and #{lastPage}
	</select>	
	<select id="selectStatus" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="mgr">
		select mgr_no as mgrNo
		,mgr_id as mgrId
		,mgr_pw as mgrPw
		,mgr_name as mgrName
		,mgr_tel as mgrTel
		,mgr_post as mgrPost
		,mgr_addr as mgrAddr
		,mgr_level as mgrLevel
		,mgr_status as mgrStatus
		,mgr_enroll_date as mgrEnrollDate
		,mgr_addr_code as mgrAddrCode
		,mgr_boss_name as mgrBossName
		,mgr_open_date as mgrOpenDate
		from
	     (select rownum as rnum, m.* from (select * from manager where mgr_status = #{status} order by mgr_no) m)
	      where rnum between #{firstPage} and #{lastPage}
	</select>
	<select id="searchStatusAddr" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="mgr">
		select mgr_no as mgrNo
		,mgr_id as mgrId
		,mgr_pw as mgrPw
		,mgr_name as mgrName
		,mgr_tel as mgrTel
		,mgr_post as mgrPost
		,mgr_addr as mgrAddr
		,mgr_level as mgrLevel
		,mgr_status as mgrStatus
		,mgr_enroll_date as mgrEnrollDate
		,mgr_addr_code as mgrAddrCode
		,mgr_boss_name as mgrBossName
		,mgr_open_date as mgrOpenDate
		from manager
		where mgr_addr like '%'||#{text}||'%' and mgr_status = #{status}
	</select>
	<select id="searchStatusName" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="mgr">
		select mgr_no as mgrNo
		,mgr_id as mgrId
		,mgr_pw as mgrPw
		,mgr_name as mgrName
		,mgr_tel as mgrTel
		,mgr_post as mgrPost
		,mgr_addr as mgrAddr
		,mgr_level as mgrLevel
		,mgr_status as mgrStatus
		,mgr_enroll_date as mgrEnrollDate
		,mgr_addr_code as mgrAddrCode
		,mgr_boss_name as mgrBossName
		,mgr_open_date as mgrOpenDate
		from manager
		where mgr_boss_name like '%'||#{text}||'%' and mgr_status = #{status}
	</select>
	<select id="searchStore" parameterType="string" resultType="mgr">
		select
		,mgr_no as mgrNo
		,mgr_id as mgrId
		,mgr_pw as mgrPw
		,mgr_name as mgrName
		,mgr_tel as mgrTel
		,mgr_post as mgrPost
		,mgr_addr as mgrAddr
		,mgr_level as mgrLevel
		,mgr_status as mgrStatus
		,mgr_enroll_date as mgrEnrollDate
		,mgr_addr_code as mgrAddrCode
		,mgr_boss_name as mgrBossName
		,mgr_open_date as mgrOpenDate
		from manager where mgr_addr like '%'||#{keyword}||'%' or mgr_name like '%'||#{keyword}||'%'
	</select>
	<select id="pageMore" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="mgr">
	   select mgr_no as mgrNo
	      ,mgr_id as mgrId
	      ,mgr_pw as mgrPw
	      ,mgr_name as mgrName
	      ,mgr_tel as mgrTel
	      ,mgr_post as mgrPost
	      ,mgr_addr as mgrAddr
	      ,mgr_level as mgrLevel
	      ,mgr_status as mgrStatus
	      ,mgr_enroll_date as mgrEnrollDate
	      ,mgr_addr_code as mgrAddrCode
	      ,mgr_boss_name as mgrBossName
	      ,mgr_open_date as mgrOpenDate        
	      from 
	        (select rownum as rnum, m.* from (select * from manager order by mgr_no) m)
	      where rnum between #{firstPage} and #{lastPage}
   </select>
   <select id="totalCount" resultType="_int">
   		select count(*)      
	      from manager
   </select>
   
   <select id="allStoreTotalCount" parameterType="string" resultType="_int">
   		select count(*)      
	      from manager where mgr_addr like '%'||#{keyword}||'%' or mgr_name like '%'||#{keyword}||'%'
   </select>
   
   <select id="addrTotalCount" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="_int">
   		select count(*)      
	      from manager where mgr_addr = #{text}
   </select>
   <select id="nameTotalCount" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="_int">
   		select count(*)      
	      from manager where mgr_boss_name = #{text}
   </select>
   <select id="statusTotalCount" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="_int">
   		select count(*)      
	      from manager where mgr_status = #{status}
   </select>
   <select id="addrStatusTotalCount" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="_int">
   		select count(*)      
	      from manager where mgr_status = #{status} and mgr_addr = #{text}
   </select>
   <select id="nameStatusTotalCount" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="_int">
   		select count(*)      
	      from manager where mgr_status = #{status} and mgr_boss_name = #{text}
   </select>

	<select id="addrMore" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="mgr">
	  	 select mgr_no as mgrNo
	      ,mgr_id as mgrId
	      ,mgr_pw as mgrPw
	      ,mgr_name as mgrName
	      ,mgr_tel as mgrTel
	      ,mgr_post as mgrPost
	      ,mgr_addr as mgrAddr
	      ,mgr_level as mgrLevel
	      ,mgr_status as mgrStatus
	      ,mgr_enroll_date as mgrEnrollDate
	      ,mgr_addr_code as mgrAddrCode
	      ,mgr_boss_name as mgrBossName
	      ,mgr_open_date as mgrOpenDate        
	      from 
	        (select rownum as rnum, m.* from (select * from manager where mgr_addr = #{text} order by mgr_no) m)
	      where rnum between #{firstPage} and #{lastPage}
   </select>
   	<select id="nameMore" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="mgr">
	  	 select mgr_no as mgrNo
	      ,mgr_id as mgrId
	      ,mgr_pw as mgrPw
	      ,mgr_name as mgrName
	      ,mgr_tel as mgrTel
	      ,mgr_post as mgrPost
	      ,mgr_addr as mgrAddr
	      ,mgr_level as mgrLevel
	      ,mgr_status as mgrStatus
	      ,mgr_enroll_date as mgrEnrollDate
	      ,mgr_addr_code as mgrAddrCode
	      ,mgr_boss_name as mgrBossName
	      ,mgr_open_date as mgrOpenDate        
	      from 
	        (select rownum as rnum, m.* from (select * from manager where mgr_boss_name = #{text} order by mgr_no) m)
	      where rnum between #{firstPage} and #{lastPage}
   </select>
   	<select id="statusMore" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="mgr">
	  	 select mgr_no as mgrNo
	      ,mgr_id as mgrId
	      ,mgr_pw as mgrPw
	      ,mgr_name as mgrName
	      ,mgr_tel as mgrTel
	      ,mgr_post as mgrPost
	      ,mgr_addr as mgrAddr
	      ,mgr_level as mgrLevel
	      ,mgr_status as mgrStatus
	      ,mgr_enroll_date as mgrEnrollDate
	      ,mgr_addr_code as mgrAddrCode
	      ,mgr_boss_name as mgrBossName
	      ,mgr_open_date as mgrOpenDate        
	      from 
	        (select rownum as rnum, m.* from (select * from manager where mgr_status = #{status} order by mgr_no order by mgr_no) m)
	      where rnum between #{firstPage} and #{lastPage}
   </select>
   	<select id="selectSearchStatusName" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="mgr">
	  	 select mgr_no as mgrNo
	      ,mgr_id as mgrId
	      ,mgr_pw as mgrPw
	      ,mgr_name as mgrName
	      ,mgr_tel as mgrTel
	      ,mgr_post as mgrPost
	      ,mgr_addr as mgrAddr
	      ,mgr_level as mgrLevel
	      ,mgr_status as mgrStatus
	      ,mgr_enroll_date as mgrEnrollDate
	      ,mgr_addr_code as mgrAddrCode
	      ,mgr_boss_name as mgrBossName
	      ,mgr_open_date as mgrOpenDate        
	      from 
	        (select rownum as rnum, m.* from (select * from manager where mgr_boss_name = #{text} and mgr_status = #{status} order by mgr_no) m)
	      where rnum between #{firstPage} and #{lastPage}
   </select>
   	<select id="selectSearchStatusAddr" parameterType="kr.co.subway.manager.vo.MgrPageData" resultType="mgr">
	  	 select mgr_no as mgrNo
	      ,mgr_id as mgrId
	      ,mgr_pw as mgrPw
	      ,mgr_name as mgrName
	      ,mgr_tel as mgrTel
	      ,mgr_post as mgrPost
	      ,mgr_addr as mgrAddr
	      ,mgr_level as mgrLevel
	      ,mgr_status as mgrStatus
	      ,mgr_enroll_date as mgrEnrollDate
	      ,mgr_addr_code as mgrAddrCode
	      ,mgr_boss_name as mgrBossName
	      ,mgr_open_date as mgrOpenDate        
	      from 
	        (select rownum as rnum, m.* from (select * from manager where mgr_addr = #{text} and mgr_status = #{status}) m)
	      where rnum between #{firstPage} and #{lastPage}
   </select>
</mapper>
